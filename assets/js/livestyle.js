/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/**
 * @license
 * Lo-Dash 1.2.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash modern -o ./dist/lodash.js`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.4.4 <http://underscorejs.org/>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
 * Available under MIT license <http://lodash.com/license>
 */

/*!
 * Simple file path manipulation utility, borrowed from Node.JS
 * Copyright Joyent, Inc. and other Node contributors.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to permit
 * persons to whom the Software is furnished to do so, subject to the
 * following conditions:
 *
 * The above copyright notice and this permission notice shall be included
 * in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
 * NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
 * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
 * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
 * USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

!function(e,t){e.livestyle=t("./livestyle/")}(this,function(e){var t,n,r;return function(e){function i(e,t){return x.call(e,t)}function a(e,t){var n,r,i,a,o,u,s,c,l,f,p=t&&t.split("/"),h=b.map,d=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(p=p.slice(0,p.length-1),e=p.concat(e.split("/")),c=0;c<e.length;c+=1)if(f=e[c],"."===f)e.splice(c,1),c-=1;else if(".."===f){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||d)&&h){for(n=e.split("/"),c=n.length;c>0;c-=1){if(r=n.slice(0,c).join("/"),p)for(l=p.length;l>0;l-=1)if(i=h[p.slice(0,l).join("/")],i&&(i=i[r])){a=i,o=c;break}if(a)break;!u&&d&&d[r]&&(u=d[r],s=c)}!a&&u&&(a=u,o=s),a&&(n.splice(0,o,a),e=n.join("/"))}return e}function o(t,n){return function(){return h.apply(e,_.call(arguments,0).concat([t,n]))}}function u(e){return function(t){return a(t,e)}}function s(e){return function(t){v[e]=t}}function c(t){if(i(m,t)){var n=m[t];delete m[t],y[t]=!0,p.apply(e,n)}if(!i(v,t)&&!i(y,t))throw new Error("No "+t);return v[t]}function l(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function f(e){return function(){return b&&b.config&&b.config[e]||{}}}var p,h,d,g,v={},m={},b={},y={},x=Object.prototype.hasOwnProperty,_=[].slice;d=function(e,t){var n,r=l(e),i=r[0];return e=r[1],i&&(i=a(i,t),n=c(i)),i?e=n&&n.normalize?n.normalize(e,u(t)):a(e,t):(e=a(e,t),r=l(e),i=r[0],e=r[1],i&&(n=c(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},g={require:function(e){return o(e)},exports:function(e){var t=v[e];return"undefined"!=typeof t?t:v[e]={}},module:function(e){return{id:e,uri:"",exports:v[e],config:f(e)}}},p=function(t,n,r,a){var u,l,f,p,h,b,x=[];if(a=a||t,"function"==typeof r){for(n=!n.length&&r.length?["require","exports","module"]:n,h=0;h<n.length;h+=1)if(p=d(n[h],a),l=p.f,"require"===l)x[h]=g.require(t);else if("exports"===l)x[h]=g.exports(t),b=!0;else if("module"===l)u=x[h]=g.module(t);else if(i(v,l)||i(m,l)||i(y,l))x[h]=c(l);else{if(!p.p)throw new Error(t+" missing "+l);p.p.load(p.n,o(a,!0),s(l),{}),x[h]=v[l]}f=r.apply(v[t],x),t&&(u&&u.exports!==e&&u.exports!==v[t]?v[t]=u.exports:f===e&&b||(v[t]=f))}else t&&(v[t]=r)},t=n=h=function(t,n,r,i,a){return"string"==typeof t?g[t]?g[t](n):c(d(t,n).f):(t.splice||(b=t,n.splice?(t=n,n=r,r=null):t=e),n=n||function(){},"function"==typeof r&&(r=i,i=a),i?p(e,t,n,r):setTimeout(function(){p(e,t,n,r)},4),h)},h.config=function(e){return b=e,b.deps&&h(b.deps,b.callback),h},r=function(e,t,n){t.splice||(n=t,t=[]),i(v,e)||i(m,e)||(m[e]=[e,t,n])},r.amd={jQuery:!0}}(),r("backend/almond",function(){}),function(e){function t(r){function i(e){return e&&"object"==typeof e&&!br(e)&&Zn.call(e,"__wrapped__")?e:new $(e)}function o(e){var t=e.length,n=t>=l;if(n)for(var r={},i=-1;++i<t;){var a=c+e[i];(r[a]||(r[a]=[])).push(e[i])}return function(t){if(n){var i=c+t;return r[i]&&Wt(r[i],t)>-1}return Wt(e,t)>-1}}function T(e){return e.charCodeAt(0)}function F(e,t){var n=e.index,r=t.index;if(e=e.criteria,t=t.criteria,e!==t){if(e>t||"undefined"==typeof e)return 1;if(t>e||"undefined"==typeof t)return-1}return r>n?-1:1}function M(e,t,n,r){function i(){var r=arguments,c=o?this:t;if(a||(e=t[u]),n.length&&(r=r.length?(r=hr.call(r),s?r.concat(n):n.concat(r)):n),this instanceof i){V.prototype=e.prototype,c=new V,V.prototype=null;var l=e.apply(c,r);return ut(l)?l:c}return e.apply(c,r)}var a=ot(e),o=!n,u=t;if(o){var s=r;n=t}else if(!a){if(!r)throw new Vn;t=e}return i}function z(e){return"\\"+U[e]}function B(e){return _r[e]}function $(e){this.__wrapped__=e}function V(){}function D(e){var t=!1;if(!e||rr.call(e)!=j)return t;var n=e.constructor;return(ot(n)?n instanceof n:!0)?(Cr(e,function(e,n){t=n}),t===!1||Zn.call(e,t)):t}function W(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,i=n-t||0,a=En(0>i?0:i);++r<i;)a[r]=e[t+r];return a}function H(e){return kr[e]}function J(e){return rr.call(e)==C}function Q(e,t,r,a,o,u){var s=e;if("function"==typeof t&&(a=r,r=t,t=!1),"function"==typeof r){if(r="undefined"==typeof a?r:i.createCallback(r,a,1),s=r(s),"undefined"!=typeof s)return s;s=e}var c=ut(s);if(c){var l=rr.call(s);if(!E[l])return s;var f=br(s)}if(!c||!t)return c?f?W(s):wr({},s):s;var p=vr[l];switch(l){case P:case O:return new p(+s);case R:case L:return new p(s);case N:return p(s.source,v.exec(s))}o||(o=[]),u||(u=[]);for(var h=o.length;h--;)if(o[h]==e)return u[h];return s=f?p(s.length):{},f&&(Zn.call(e,"index")&&(s.index=e.index),Zn.call(e,"input")&&(s.input=e.input)),o.push(e),u.push(s),(f?Ct:Ar)(e,function(e,i){s[i]=Q(e,t,r,n,o,u)}),s}function G(e,t,n){return Q(e,!0,t,n)}function Y(e,t,n){var r;return t=i.createCallback(t,n),Ar(e,function(e,n,i){return t(e,n,i)?(r=n,!1):void 0}),r}function K(e){var t=[];return Cr(e,function(e,n){ot(e)&&t.push(n)}),t.sort()}function X(e,t){return e?Zn.call(e,t):!1}function Z(e){for(var t=-1,n=xr(e),r=n.length,i={};++t<r;){var a=n[t];i[e[a]]=a}return i}function et(e){return e===!0||e===!1||rr.call(e)==P}function tt(e){return e?"object"==typeof e&&rr.call(e)==O:!1}function nt(e){return e?1===e.nodeType:!1}function rt(e){var t=!0;if(!e)return t;var n=rr.call(e),r=e.length;return n==A||n==L||n==C||n==j&&"number"==typeof r&&ot(e.splice)?!r:(Ar(e,function(){return t=!1}),t)}function it(e,t,n,r,a,o){var u=n===s;if("function"==typeof n&&!u){n=i.createCallback(n,r,2);var c=n(e,t);if("undefined"!=typeof c)return!!c}if(e===t)return 0!==e||1/e==1/t;var l=typeof e,f=typeof t;if(e===e&&(!e||"function"!=l&&"object"!=l)&&(!t||"function"!=f&&"object"!=f))return!1;if(null==e||null==t)return e===t;var p=rr.call(e),h=rr.call(t);if(p==C&&(p=j),h==C&&(h=j),p!=h)return!1;switch(p){case P:case O:return+e==+t;case R:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case N:case L:return e==$n(t)}var d=p==A;if(!d){if(Zn.call(e,"__wrapped__ ")||Zn.call(t,"__wrapped__"))return it(e.__wrapped__||e,t.__wrapped__||t,n,r,a,o);if(p!=j)return!1;var g=e.constructor,v=t.constructor;if(g!=v&&!(ot(g)&&g instanceof g&&ot(v)&&v instanceof v))return!1}a||(a=[]),o||(o=[]);for(var m=a.length;m--;)if(a[m]==e)return o[m]==t;var b=0;if(c=!0,a.push(e),o.push(t),d){if(m=e.length,b=t.length,c=b==e.length,!c&&!u)return c;for(;b--;){var y=m,x=t[b];if(u)for(;y--&&!(c=it(e[y],x,n,r,a,o)););else if(!(c=it(e[b],x,n,r,a,o)))break}return c}return Cr(t,function(t,i,u){return Zn.call(u,i)?(b++,c=Zn.call(e,i)&&it(e[i],t,n,r,a,o)):void 0}),c&&!u&&Cr(e,function(e,t,n){return Zn.call(n,t)?c=--b>-1:void 0}),c}function at(e){return or(e)&&!ur(parseFloat(e))}function ot(e){return"function"==typeof e}function ut(e){return e?I[typeof e]:!1}function st(e){return lt(e)&&e!=+e}function ct(e){return null===e}function lt(e){return"number"==typeof e||rr.call(e)==R}function ft(e){return e?"object"==typeof e&&rr.call(e)==N:!1}function pt(e){return"string"==typeof e||rr.call(e)==L}function ht(e){return"undefined"==typeof e}function dt(e,t,n){var r=arguments,a=0,o=2;if(!ut(e))return e;if(n===s)var u=r[3],c=r[4],l=r[5];else c=[],l=[],"number"!=typeof n&&(o=r.length),o>3&&"function"==typeof r[o-2]?u=i.createCallback(r[--o-1],r[o--],2):o>2&&"function"==typeof r[o-1]&&(u=r[--o]);for(;++a<o;)(br(r[a])?Ct:Ar)(r[a],function(t,n){var r,i,a=t,o=e[n];if(t&&((i=br(t))||Pr(t))){for(var f=c.length;f--;)if(r=c[f]==t){o=l[f];break}if(!r){var p;u&&(a=u(o,t),(p="undefined"!=typeof a)&&(o=a)),p||(o=i?br(o)?o:[]:Pr(o)?o:{}),c.push(t),l.push(o),p||(o=dt(o,t,s,u,c,l))}}else u&&(a=u(o,t),"undefined"==typeof a&&(a=t)),"undefined"!=typeof a&&(o=a);e[n]=o});return e}function gt(e,t,n){var r="function"==typeof t,a={};if(r)t=i.createCallback(t,n);else var o=Yn.apply(Dn,hr.call(arguments,1));return Cr(e,function(e,n,i){(r?!t(e,n,i):Wt(o,n)<0)&&(a[n]=e)}),a}function vt(e){for(var t=-1,n=xr(e),r=n.length,i=En(r);++t<r;){var a=n[t];i[t]=[a,e[a]]}return i}function mt(e,t,n){var r={};if("function"!=typeof t)for(var a=-1,o=Yn.apply(Dn,hr.call(arguments,1)),u=ut(e)?o.length:0;++a<u;){var s=o[a];s in e&&(r[s]=e[s])}else t=i.createCallback(t,n),Cr(e,function(e,n,i){t(e,n,i)&&(r[n]=e)});return r}function bt(e){for(var t=-1,n=xr(e),r=n.length,i=En(r);++t<r;)i[t]=e[n[t]];return i}function yt(e){for(var t=-1,n=Yn.apply(Dn,hr.call(arguments,1)),r=n.length,i=En(r);++t<r;)i[t]=e[n[t]];return i}function xt(e,t,n){var r=-1,i=e?e.length:0,a=!1;return n=(0>n?cr(0,i+n):n)||0,"number"==typeof i?a=(pt(e)?e.indexOf(t,n):Wt(e,t,n))>-1:Ar(e,function(e){return++r>=n?!(a=e===t):void 0}),a}function _t(e,t,n){var r={};return t=i.createCallback(t,n),Ct(e,function(e,n,i){n=$n(t(e,n,i)),Zn.call(r,n)?r[n]++:r[n]=1}),r}function kt(e,t,n){var r=!0;t=i.createCallback(t,n);var a=-1,o=e?e.length:0;if("number"==typeof o)for(;++a<o&&(r=!!t(e[a],a,e)););else Ar(e,function(e,n,i){return r=!!t(e,n,i)});return r}function wt(e,t,n){var r=[];t=i.createCallback(t,n);var a=-1,o=e?e.length:0;if("number"==typeof o)for(;++a<o;){var u=e[a];t(u,a,e)&&r.push(u)}else Ar(e,function(e,n,i){t(e,n,i)&&r.push(e)});return r}function St(e,t,n){t=i.createCallback(t,n);var r=-1,a=e?e.length:0;if("number"!=typeof a){var o;return Ar(e,function(e,n,r){return t(e,n,r)?(o=e,!1):void 0}),o}for(;++r<a;){var u=e[r];if(t(u,r,e))return u}}function Ct(e,t,n){var r=-1,a=e?e.length:0;if(t=t&&"undefined"==typeof n?t:i.createCallback(t,n),"number"==typeof a)for(;++r<a&&t(e[r],r,e)!==!1;);else Ar(e,t);return e}function At(e,t,n){var r={};return t=i.createCallback(t,n),Ct(e,function(e,n,i){n=$n(t(e,n,i)),(Zn.call(r,n)?r[n]:r[n]=[]).push(e)}),r}function Pt(e,t){var n=hr.call(arguments,2),r=-1,i="function"==typeof t,a=e?e.length:0,o=En("number"==typeof a?a:0);return Ct(e,function(e){o[++r]=(i?t:e[t]).apply(e,n)}),o}function Ot(e,t,n){var r=-1,a=e?e.length:0;if(t=i.createCallback(t,n),"number"==typeof a)for(var o=En(a);++r<a;)o[r]=t(e[r],r,e);else o=[],Ar(e,function(e,n,i){o[++r]=t(e,n,i)});return o}function Tt(e,t,n){var r=-1/0,a=r;if(!t&&br(e))for(var o=-1,u=e.length;++o<u;){var s=e[o];s>a&&(a=s)}else t=!t&&pt(e)?T:i.createCallback(t,n),Ct(e,function(e,n,i){var o=t(e,n,i);o>r&&(r=o,a=e)});return a}function Rt(e,t,n){var r=1/0,a=r;if(!t&&br(e))for(var o=-1,u=e.length;++o<u;){var s=e[o];a>s&&(a=s)}else t=!t&&pt(e)?T:i.createCallback(t,n),Ct(e,function(e,n,i){var o=t(e,n,i);r>o&&(r=o,a=e)});return a}function jt(e,t){var n=-1,r=e?e.length:0;if("number"==typeof r)for(var i=En(r);++n<r;)i[n]=e[n][t];return i||Ot(e,t)}function Nt(e,t,n,r){if(!e)return n;var a=arguments.length<3;t=i.createCallback(t,r,4);var o=-1,u=e.length;if("number"==typeof u)for(a&&(n=e[++o]);++o<u;)n=t(n,e[o],o,e);else Ar(e,function(e,r,i){n=a?(a=!1,e):t(n,e,r,i)});return n}function Lt(e,t,n,r){var a=e,o=e?e.length:0,u=arguments.length<3;if("number"!=typeof o){var s=xr(e);o=s.length}return t=i.createCallback(t,r,4),Ct(e,function(e,r,i){r=s?s[--o]:--o,n=u?(u=!1,a[r]):t(n,a[r],r,i)}),n}function Et(e,t,n){return t=i.createCallback(t,n),wt(e,function(e,n,r){return!t(e,n,r)})}function It(e){var t=-1,n=e?e.length:0,r=En("number"==typeof n?n:0);return Ct(e,function(e){var n=Kn(pr()*(++t+1));r[t]=r[n],r[n]=e}),r}function Ut(e){var t=e?e.length:0;return"number"==typeof t?t:xr(e).length}function qt(e,t,n){var r;t=i.createCallback(t,n);var a=-1,o=e?e.length:0;if("number"==typeof o)for(;++a<o&&!(r=t(e[a],a,e)););else Ar(e,function(e,n,i){return!(r=t(e,n,i))});return!!r}function Ft(e,t,n){var r=-1,a=e?e.length:0,o=En("number"==typeof a?a:0);for(t=i.createCallback(t,n),Ct(e,function(e,n,i){o[++r]={criteria:t(e,n,i),index:r,value:e}}),a=o.length,o.sort(F);a--;)o[a]=o[a].value;return o}function Mt(e){return e&&"number"==typeof e.length?W(e):bt(e)}function zt(e){for(var t=-1,n=e?e.length:0,r=[];++t<n;){var i=e[t];i&&r.push(i)}return r}function Bt(e){for(var t=-1,n=e?e.length:0,r=Yn.apply(Dn,hr.call(arguments,1)),i=o(r),a=[];++t<n;){var u=e[t];i(u)||a.push(u)}return a}function $t(e,t,n){var r=-1,a=e?e.length:0;for(t=i.createCallback(t,n);++r<a;)if(t(e[r],r,e))return r;return-1}function Vt(e,t,n){if(e){var r=0,a=e.length;if("number"!=typeof t&&null!=t){var o=-1;for(t=i.createCallback(t,n);++o<a&&t(e[o],o,e);)r++}else if(r=t,null==r||n)return e[0];return W(e,0,lr(cr(0,r),a))}}function Dt(e,t,n,r){var a=-1,o=e?e.length:0,u=[];for("boolean"!=typeof t&&null!=t&&(r=n,n=t,t=!1),null!=n&&(n=i.createCallback(n,r));++a<o;){var s=e[a];n&&(s=n(s,a,e)),br(s)?er.apply(u,t?s:Dt(s)):u.push(s)}return u}function Wt(e,t,n){var r=-1,i=e?e.length:0;if("number"==typeof n)r=(0>n?cr(0,i+n):n||0)-1;else if(n)return r=Xt(e,t),e[r]===t?r:-1;for(;++r<i;)if(e[r]===t)return r;return-1}function Ht(e,t,n){if(!e)return[];var r=0,a=e.length;if("number"!=typeof t&&null!=t){var o=a;for(t=i.createCallback(t,n);o--&&t(e[o],o,e);)r++}else r=null==t||n?1:t||r;return W(e,0,lr(cr(0,a-r),a))}function Jt(e){var t=arguments,n=t.length,r={0:{}},i=-1,a=e?e.length:0,u=a>=l,s=[],f=s;e:for(;++i<a;){var p=e[i];if(u)var h=c+p,d=r[0][h]?!(f=r[0][h]):f=r[0][h]=[];if(d||Wt(f,p)<0){u&&f.push(p);for(var g=n;--g;)if(!(r[g]||(r[g]=o(t[g])))(p))continue e;s.push(p)}}return s}function Qt(e,t,n){if(e){var r=0,a=e.length;if("number"!=typeof t&&null!=t){var o=a;for(t=i.createCallback(t,n);o--&&t(e[o],o,e);)r++}else if(r=t,null==r||n)return e[a-1];return W(e,cr(0,a-r))}}function Gt(e,t,n){var r=e?e.length:0;for("number"==typeof n&&(r=(0>n?cr(0,r+n):lr(n,r-1))+1);r--;)if(e[r]===t)return r;return-1}function Yt(e,t,n){e=+e||0,n=+n||1,null==t&&(t=e,e=0);for(var r=-1,i=cr(0,Qn((t-e)/n)),a=En(i);++r<i;)a[r]=e,e+=n;return a}function Kt(e,t,n){if("number"!=typeof t&&null!=t){var r=0,a=-1,o=e?e.length:0;for(t=i.createCallback(t,n);++a<o&&t(e[a],a,e);)r++}else r=null==t||n?1:cr(0,t);return W(e,r)}function Xt(e,t,n,r){var a=0,o=e?e.length:a;for(n=n?i.createCallback(n,r,1):kn,t=n(t);o>a;){var u=a+o>>>1;n(e[u])<t?a=u+1:o=u}return a}function Zt(e){return br(e)||(arguments[0]=e?hr.call(e):Dn),en(Yn.apply(Dn,arguments))}function en(e,t,n,r){var a=-1,o=e?e.length:0,u=[],s=u;"boolean"!=typeof t&&null!=t&&(r=n,n=t,t=!1);var f=!t&&o>=l;if(f)var p={};for(null!=n&&(s=[],n=i.createCallback(n,r));++a<o;){var h=e[a],d=n?n(h,a,e):h;if(f)var g=c+d,v=p[g]?!(s=p[g]):s=p[g]=[];(t?!a||s[s.length-1]!==d:v||Wt(s,d)<0)&&((n||f)&&s.push(d),u.push(h))}return u}function tn(e){for(var t=-1,n=e?e.length:0,r=n?Tt(jt(e,"length")):0,i=En(r);++t<n;)for(var a=-1,o=e[t];++a<r;)(i[a]||(i[a]=En(n)))[t]=o[a];return i}function nn(e){return Bt(e,hr.call(arguments,1))}function rn(e){for(var t=-1,n=e?Tt(jt(arguments,"length")):0,r=En(n);++t<n;)r[t]=jt(arguments,t);return r}function an(e,t){for(var n=-1,r=e?e.length:0,i={};++n<r;){var a=e[n];t?i[a]=t[n]:i[a[0]]=a[1]}return i}function on(e,t){return 1>e?t():function(){return--e<1?t.apply(this,arguments):void 0}}function un(e,t){return mr.fastBind||ir&&arguments.length>2?ir.call.apply(ir,arguments):M(e,t,hr.call(arguments,2))}function sn(e){for(var t=arguments.length>1?Yn.apply(Dn,hr.call(arguments,1)):K(e),n=-1,r=t.length;++n<r;){var i=t[n];e[i]=un(e[i],e)}return e}function cn(e,t){return M(e,t,hr.call(arguments,2),s)}function ln(){var e=arguments;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}}function fn(e,t,n){if(null==e)return kn;var r=typeof e;if("function"!=r){if("object"!=r)return function(t){return t[e]};var i=xr(e);return function(t){for(var n=i.length,r=!1;n--&&(r=it(t[i[n]],e[i[n]],s)););return r}}return"undefined"!=typeof t?1===n?function(n){return e.call(t,n)}:2===n?function(n,r){return e.call(t,n,r)}:4===n?function(n,r,i,a){return e.call(t,n,r,i,a)}:function(n,r,i){return e.call(t,n,r,i)}:e}function pn(e,t,n){function r(){a=s=null,c&&(o=e.apply(u,i))}var i,a,o,u,s,c=!0;if(n===!0){var l=!0;c=!1}else n&&I[typeof n]&&(l=n.leading,c="trailing"in n?n.trailing:c);return function(){return i=arguments,u=this,Gn(s),!a&&l?(a=!0,o=e.apply(u,i)):s=nr(r,t),o}}function hn(e){var t=hr.call(arguments,1);return nr(function(){e.apply(n,t)},1)}function dn(e,t){var r=hr.call(arguments,2);return nr(function(){e.apply(n,r)},t)}function gn(e,t){var n={};return function(){var r=c+(t?t.apply(this,arguments):arguments[0]);return Zn.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}}function vn(e){var t,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}}function mn(e){return M(e,hr.call(arguments,1))}function bn(e){return M(e,hr.call(arguments,1),null,s)}function yn(e,t,n){function r(){u=null,l&&(s=new Un,a=e.apply(o,i))}var i,a,o,u,s=0,c=!0,l=!0;return n===!1?c=!1:n&&I[typeof n]&&(c="leading"in n?n.leading:c,l="trailing"in n?n.trailing:l),function(){var n=new Un;u||c||(s=n);var l=t-(n-s);return i=arguments,o=this,0>=l?(Gn(u),u=null,s=n,a=e.apply(o,i)):u||(u=nr(r,l)),a}}function xn(e,t){return function(){var n=[e];return er.apply(n,arguments),t.apply(this,n)}}function _n(e){return null==e?"":$n(e).replace(_,B)}function kn(e){return e}function wn(e){Ct(K(e),function(t){var n=i[t]=e[t];i.prototype[t]=function(){var e=this.__wrapped__,t=[e];er.apply(t,arguments);var r=n.apply(i,t);return e&&"object"==typeof e&&e==r?this:new $(r)}})}function Sn(){return r._=Hn,this}function Cn(e,t){return null==e&&null==t&&(t=1),e=+e||0,null==t&&(t=e,e=0),e+Kn(pr()*((+t||0)-e+1))}function An(e,t){var r=e?e[t]:n;return ot(r)?e[t]():r}function Pn(e,t,r){var a=i.templateSettings;e||(e=""),r=Sr({},r,a);var o,u=Sr({},r.imports,a.imports),s=xr(u),c=bt(u),l=0,d=r.interpolate||x,v="__p += '",b=Bn((r.escape||x).source+"|"+d.source+"|"+(d===m?g:x).source+"|"+(r.evaluate||x).source+"|$","g");e.replace(b,function(t,n,r,i,a,u){return r||(r=i),v+=e.slice(l,u).replace(k,z),n&&(v+="' +\n__e("+n+") +\n'"),a&&(o=!0,v+="';\n"+a+";\n__p += '"),r&&(v+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+t.length,t}),v+="';\n";var y=r.variable,_=y;_||(y="obj",v="with ("+y+") {\n"+v+"\n}\n"),v=(o?v.replace(f,""):v).replace(p,"$1").replace(h,"$1;"),v="function("+y+") {\n"+(_?"":y+" || ("+y+" = {});\n")+"var __t, __p = '', __e = _.escape"+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+v+"return __p\n}";var w="\n/*\n//@ sourceURL="+(r.sourceURL||"/lodash/template/source["+S++ +"]")+"\n*/";try{var C=qn(s,"return "+v+w).apply(n,c)}catch(A){throw A.source=v,A}return t?C(t):(C.source=v,C)}function On(e,t,n){e=(e=+e)>-1?e:0;var r=-1,a=En(e);for(t=i.createCallback(t,n,1);++r<e;)a[r]=t(r);return a}function Tn(e){return null==e?"":$n(e).replace(d,H)}function Rn(e){var t=++u;return $n(null==e?"":e)+t}function jn(e,t){return t(e),e}function Nn(){return $n(this.__wrapped__)}function Ln(){return this.__wrapped__}r=r?q.defaults(e.Object(),r,q.pick(e,w)):e;var En=r.Array,In=r.Boolean,Un=r.Date,qn=r.Function,Fn=r.Math,Mn=r.Number,zn=r.Object,Bn=r.RegExp,$n=r.String,Vn=r.TypeError,Dn=En(),Wn=zn(),Hn=r._,Jn=Bn("^"+$n(Wn.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Qn=Fn.ceil,Gn=r.clearTimeout,Yn=Dn.concat,Kn=Fn.floor,Xn=Jn.test(Xn=zn.getPrototypeOf)&&Xn,Zn=Wn.hasOwnProperty,er=Dn.push,tr=r.setImmediate,nr=r.setTimeout,rr=Wn.toString,ir=Jn.test(ir=rr.bind)&&ir,ar=Jn.test(ar=En.isArray)&&ar,or=r.isFinite,ur=r.isNaN,sr=Jn.test(sr=zn.keys)&&sr,cr=Fn.max,lr=Fn.min,fr=r.parseInt,pr=Fn.random,hr=Dn.slice,dr=Jn.test(r.attachEvent),gr=ir&&!/\n|true/.test(ir+dr),vr={};vr[A]=En,vr[P]=In,vr[O]=Un,vr[j]=zn,vr[R]=Mn,vr[N]=Bn,vr[L]=$n;var mr=i.support={};mr.fastBind=ir&&!gr,i.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:m,variable:"",imports:{_:i}},$.prototype=i.prototype;var br=ar,yr=function(e){var t,n=e,r=[];if(!n)return r;if(!I[typeof e])return r;for(t in n)Zn.call(n,t)&&r.push(t);return r},xr=sr?function(e){return ut(e)?sr(e):[]}:yr,_r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},kr=Z(_r),wr=function(e,t,n){var r,a=e,o=a;if(!a)return o;var u=arguments,s=0,c="number"==typeof n?2:u.length;if(c>3&&"function"==typeof u[c-2])var l=i.createCallback(u[--c-1],u[c--],2);else c>2&&"function"==typeof u[c-1]&&(l=u[--c]);for(;++s<c;)if(a=u[s],a&&I[typeof a]){var f=a.length;if(r=-1,br(a))for(;++r<f;)o[r]=l?l(o[r],a[r]):a[r];else for(var p=-1,h=I[typeof a]?xr(a):[],f=h.length;++p<f;)r=h[p],o[r]=l?l(o[r],a[r]):a[r]}return o},Sr=function(e,t,n){var r,i=e,a=i;if(!i)return a;for(var o=arguments,u=0,s="number"==typeof n?2:o.length;++u<s;)if(i=o[u],i&&I[typeof i]){var c=i.length;if(r=-1,br(i))for(;++r<c;)"undefined"==typeof a[r]&&(a[r]=i[r]);else for(var l=-1,f=I[typeof i]?xr(i):[],c=f.length;++l<c;)r=f[l],"undefined"==typeof a[r]&&(a[r]=i[r])}return a},Cr=function(e,t,n){var r,a=e,o=a;if(!a)return o;if(!I[typeof a])return o;t=t&&"undefined"==typeof n?t:i.createCallback(t,n);for(r in a)if(t(a[r],r,e)===!1)return o;return o},Ar=function(e,t,n){var r,a=e,o=a;if(!a)return o;if(!I[typeof a])return o;t=t&&"undefined"==typeof n?t:i.createCallback(t,n);for(var u=-1,s=I[typeof a]?xr(a):[],c=s.length;++u<c;)if(r=s[u],t(a[r],r,e)===!1)return o;return o},Pr=function(e){if(!e||rr.call(e)!=j)return!1;var t=e.valueOf,n="function"==typeof t&&(n=Xn(t))&&Xn(n);return n?e==n||Xn(e)==n:D(e)},Or=wt;gr&&a&&"function"==typeof tr&&(hn=un(tr,r));var Tr=8==fr(b+"08")?fr:function(e,t){return fr(pt(e)?e.replace(y,""):e,t||0)};return i.after=on,i.assign=wr,i.at=yt,i.bind=un,i.bindAll=sn,i.bindKey=cn,i.compact=zt,i.compose=ln,i.countBy=_t,i.createCallback=fn,i.debounce=pn,i.defaults=Sr,i.defer=hn,i.delay=dn,i.difference=Bt,i.filter=wt,i.flatten=Dt,i.forEach=Ct,i.forIn=Cr,i.forOwn=Ar,i.functions=K,i.groupBy=At,i.initial=Ht,i.intersection=Jt,i.invert=Z,i.invoke=Pt,i.keys=xr,i.map=Ot,i.max=Tt,i.memoize=gn,i.merge=dt,i.min=Rt,i.omit=gt,i.once=vn,i.pairs=vt,i.partial=mn,i.partialRight=bn,i.pick=mt,i.pluck=jt,i.range=Yt,i.reject=Et,i.rest=Kt,i.shuffle=It,i.sortBy=Ft,i.tap=jn,i.throttle=yn,i.times=On,i.toArray=Mt,i.union=Zt,i.uniq=en,i.unzip=tn,i.values=bt,i.where=Or,i.without=nn,i.wrap=xn,i.zip=rn,i.zipObject=an,i.collect=Ot,i.drop=Kt,i.each=Ct,i.extend=wr,i.methods=K,i.object=an,i.select=wt,i.tail=Kt,i.unique=en,wn(i),i.clone=Q,i.cloneDeep=G,i.contains=xt,i.escape=_n,i.every=kt,i.find=St,i.findIndex=$t,i.findKey=Y,i.has=X,i.identity=kn,i.indexOf=Wt,i.isArguments=J,i.isArray=br,i.isBoolean=et,i.isDate=tt,i.isElement=nt,i.isEmpty=rt,i.isEqual=it,i.isFinite=at,i.isFunction=ot,i.isNaN=st,i.isNull=ct,i.isNumber=lt,i.isObject=ut,i.isPlainObject=Pr,i.isRegExp=ft,i.isString=pt,i.isUndefined=ht,i.lastIndexOf=Gt,i.mixin=wn,i.noConflict=Sn,i.parseInt=Tr,i.random=Cn,i.reduce=Nt,i.reduceRight=Lt,i.result=An,i.runInContext=t,i.size=Ut,i.some=qt,i.sortedIndex=Xt,i.template=Pn,i.unescape=Tn,i.uniqueId=Rn,i.all=kt,i.any=qt,i.detect=St,i.foldl=Nt,i.foldr=Lt,i.include=xt,i.inject=Nt,Ar(i,function(e,t){i.prototype[t]||(i.prototype[t]=function(){var t=[this.__wrapped__];return er.apply(t,arguments),e.apply(i,t)})}),i.first=Vt,i.last=Qt,i.take=Vt,i.head=Vt,Ar(i,function(e,t){i.prototype[t]||(i.prototype[t]=function(t,n){var r=e(this.__wrapped__,t,n);return null==t||n&&"function"!=typeof t?r:new $(r)})}),i.VERSION="1.2.1",i.prototype.toString=Nn,i.prototype.value=Ln,i.prototype.valueOf=Ln,Ct(["join","pop","shift"],function(e){var t=Dn[e];i.prototype[e]=function(){return t.apply(this.__wrapped__,arguments)}}),Ct(["push","reverse","sort","unshift"],function(e){var t=Dn[e];i.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Ct(["concat","slice","splice"],function(e){var t=Dn[e];i.prototype[e]=function(){return new $(t.apply(this.__wrapped__,arguments))}}),i}var n,i="object"==typeof exports&&exports,a="object"==typeof module&&module&&module.exports==i&&module,o="object"==typeof global&&global;(o.global===o||o.window===o)&&(e=o);var u=0,s={},c=+new Date+"",l=200,f=/\b__p \+= '';/g,p=/\b(__p \+=) '' \+/g,h=/(__e\(.*?\)|\b__t\)) \+\n'';/g,d=/&(?:amp|lt|gt|quot|#39);/g,g=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,v=/\w*$/,m=/<%=([\s\S]+?)%>/g,b=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",y=RegExp("^["+b+"]*0+(?=.$)"),x=/($^)/,_=/[&<>"']/g,k=/['\n\r\t\u2028\u2029\\]/g,w=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setImmediate","setTimeout"],S=0,C="[object Arguments]",A="[object Array]",P="[object Boolean]",O="[object Date]",T="[object Function]",R="[object Number]",j="[object Object]",N="[object RegExp]",L="[object String]",E={};E[T]=!1,E[C]=E[A]=E[P]=E[O]=E[R]=E[j]=E[N]=E[L]=!0;var I={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},U={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},q=t();r("lodash",[],function(){return q})}(this),r("cssParser",[],function(){function e(e,t){return t=t||e.charCodeAt(0),t>=97&&122>=t||t>=65&&90>=t||t>=1024&&1279>=t||"&"===e||"_"===e||"-"===e}function t(e,t){return t=t||e.charCodeAt(0),t>=48&&57>=t}function n(e,t){p.tokens.push({value:e,type:t||e,start:null,end:null})}function r(e){var t=h,n=p.tokens;return p.tokens=null,{name:"ParseError",message:e+" at char "+(t.chnum+1),walker:t,tokens:n}}function i(){for(var e=h.ch,t="";" "===e||"	"===e;)t+=e,e=h.nextChar();n(t,"white")}function a(){var e,t=h,r=t.ch,i=r;if(e=t.nextChar(),"/"===e){i+=e;for(var a=t.peek();a&&"\n"!==a;)i+=e,e=t.nextChar(),a=t.peek()}else{if("*"!==e)return n(i,i);for(;"*"!==r||"/"!==e;)i+=e,r=e,e=t.nextChar()}i+=e,t.nextChar(),n(i,"comment")}function o(){var e,t=h,i=t.ch,a=i,o=i;for(i=t.nextChar();i!==a;){if("\n"===i){if(e=t.nextChar(),"\\"!==e)throw r("Unterminated string");o+=i+e}else o+="\\"===i?i+t.nextChar():i;i=t.nextChar()}o+=i,t.nextChar(),n(o,"string")}function u(){var e=h,t=e.ch,i=0,a=t;for(t=e.nextChar();")"!==t&&!i;){if("("===t)i++;else if(")"===t)i--;else if(""===t)throw r("Unterminated brace");a+=t,t=e.nextChar()}a+=t,e.nextChar(),n(a,"brace")}function s(r){var i=h.ch,a=r?r+i:i;i=h.nextChar();for(var o=i.charCodeAt(0);e(i,o)||t(i,o);)a+=i,i=h.nextChar(),o=i.charCodeAt(0);n(a,"identifier")}function c(){var e,r=h,i=r.ch,a=i,o="."===a;if(i=r.nextChar(),e=!t(i),o&&e)return n(a,".");if("-"===a&&e)return s("-");for(;""!==i&&(t(i)||!o&&"."===i);)"."===i&&(o=!0),a+=i,i=r.nextChar();n(a,"number")}function l(){var e=h,t=e.ch,r=t,i=e.nextChar();return"="===i&&d(r,!0)?(r+=i,n(r,"match"),e.nextChar(),void 0):(n(r,r),void 0)}function f(){var f=h.ch;if(" "===f||"	"===f)return i();if("/"===f)return a();if('"'===f||"'"===f)return o();if("("===f)return u();if("-"===f||"."===f||t(f))return c();if(e(f))return s();if(d(f))return l();if("\r"===f)return"\n"===h.peek()&&(f+=h.nextChar()),n(f,"line"),h.nextChar(),void 0;if("\n"===f)return n(f,"line"),h.nextChar(),void 0;throw r("Unrecognized character '"+f+"'")}var p={tokens:null},h={init:function(e){this.source=e,this.ch="",this.chnum=-1,this.nextChar()},nextChar:function(){return this.ch=this.source.charAt(++this.chnum)},peek:function(){return this.source.charAt(this.chnum+1)}},d=function(){for(var e="{}[]()+*=.,;:>~|\\%$#@^!".split(""),t="*^|$~".split(""),n={},r={},i=0;i<e.length;i+=1)n[e[i]]=!0;for(i=0;i<t.length;i+=1)r[t[i]]=!0;return function(e,t){return t?e in r:e in n}}();return{lex:function(e){if(h.init(e),p.tokens=[],e)for(;""!==h.ch;)f();else p.tokens.push(this.white());var t=p.tokens;return p.tokens=null,t},parse:function(e){for(var t,n=this.lex(e),r=0,i=0,a=n.length;a>i;i++)t=n[i],t.start=r,t.end=r+=t.value.length;return n},white:function(){return{value:"",type:"white",start:0,end:0}},toSource:function(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}}}),r("range",["lodash"],function(e){function t(e,t,n){switch(n){case"eq":case"==":return e===t;case"lt":case"<":return t>e;case"lte":case"<=":return t>=e;case"gt":case">":return e>t;case"gte":case">=":return e>=t}}function n(t,n){"object"==typeof t&&"start"in t?(this.start=Math.min(t.start,t.end),this.end=Math.max(t.start,t.end)):e.isArray(t)?(this.start=t[0],this.end=t[1]):(n="string"==typeof t?n.length:+n,this.start=t,this.end=t+n)}return n.prototype={length:function(){return this.end-this.start},equal:function(e){return this.cmp(e,"eq","eq")},shift:function(e){return this.start+=e,this.end+=e,this},overlap:function(e){return e.start<=this.end&&e.end>=this.start},intersection:function(e){if(this.overlap(e)){var t=Math.max(e.start,this.start),r=Math.min(e.end,this.end);return new n(t,r-t)}return null},union:function(e){if(this.overlap(e)){var t=Math.min(e.start,this.start),r=Math.max(e.end,this.end);return new n(t,r-t)}return null},inside:function(e){return this.cmp(e,"lte","gt")},contains:function(e){return this.cmp(e,"lt","gt")},include:function(e){return this.cmp(e,"lte","gte")},cmp:function(e,r,i){var a,o;return e instanceof n?(a=e.start,o=e.end):a=o=e,t(this.start,a,r||"<=")&&t(this.end,o,i||">")},substring:function(e){return this.length()>0?e.substring(this.start,this.end):""},clone:function(){return new n(this.start,this.length())},toArray:function(){return[this.start,this.end]},toString:function(){return this.valueOf()},valueOf:function(){return"{"+this.start+", "+this.length()+"}"}},{create:function(e,t){return"undefined"==typeof e||null===e?null:e instanceof n?e:("object"==typeof e&&"start"in e&&"end"in e&&(t=e.end-e.start,e=e.start),new n(e,t))},create2:function(t,n){return e.isNumber(t)&&e.isNumber(n)&&(n-=t),this.create(t,n)}}}),r("tree",["lodash","cssParser","range"],function(e,t,n){function r(e,t,n){n=n||{},this.nameRange=e,this.valueRange=t,this.children=[],this.parent=null,this.type=n.type||"section",this._name=null,this._nameLower=null,this._value=null,this._hints=n}function i(e,t){this.tokens=e,this.len=e.length,this.source=t,this.start=this.pos=0,this.root=new r(null,null,{type:"root",startToken:0,endToken:this.len-1}),this.root._source=t,this.root.tokens=e,this.ctx=this.root}function a(t,n){var r=function(e,t){e[t]>=n.tokenStart&&(e[t]+=n.tokenOffset,e[t]<0&&(e[t]=0))};e.each(t,function(e){var t=e._hints;r(t,"startToken"),r(t,"endToken"),t.name&&(r(t.name,0),r(t.name,1));var i=e.nameRange;e.nameRange&&(i.start>=n.charStart&&(i.start+=n.charOffset),i.end>=n.charStart&&(i.end+=n.charOffset)),e.valueRange&&(i=e.valueRange,i.start>=n.charStart&&(i.start+=n.charOffset),i.end>=n.charStart&&(i.end+=n.charOffset))})}function o(e){return e.trim().replace(h," ")}function u(n){var r=e.isArray(n)?n:t.lex(n);r=e.filter(r,function(e){return"comment"!==e.type});for(var i,a="",u=[],s=0,c=r.length;c>s;s++)i=r[s],","===i.type?(u.push(o(a)),a=""):a+="line"===i.type?" ":i.value;return u.push(o(a)),e.compact(u)}function s(e){return l(e,d)}function c(e){return l(e,g)}function l(e,t){for(var n,r=!1;(n=e.peek())&&n.type in t;)r=!0,e.next();return r}function f(e){s(e);var t=function(){return[e.start,e.pos]};e.start=e.pos;for(var i,a,o,u;i=e.peek();)if("@"===i.type){if(e.start=e.pos,e.skipTo(v),";"===e.peek().type){var l=e.curRange(!0),p=l.substring(e.source),h=p.match(/^@?\w+/)[0],d=l.start;l.start+=h.length;var g={startToken:e.start,endToken:e.pos};e.ctx.addChild(new r(n.create2(d,l.start),l,g)),e.next(),s(e),e.start=e.pos;continue}}else if("{"===i.type||":"===i.type)if(a=e.curRange(!0),u=t(),e.next(),"{"===i.type){i.start;var b=e.ctx.addChild(new r(a,null,{name:u,startToken:u[0]}));e.ctx=b,f(e),e.ctx=e.ctx.parent;var y,x;e.peek()?(y=e.peek().end,x=e.pos):(x=e.tokens.length-1,y=e.tokens[x].end),b.valueRange=n.create2(i.start,y),b._hints.endToken=x,e.next(),s(e),e.start=e.pos}else{for(var _,k=e.pos,w=!1;_=e.next();){if("{"===_.type){e.backUp(1),w=!0;break}if(";"===_.type||"}"===_.type){e.pos=k;break}}if(w)continue;e.start=e.pos,e.skipTo(m),o=e.curRange(!0);var x=e.pos;"}"===e.peek().type&&x--,e.ctx.addChild(new r(a,o,{type:"property",name:u,startToken:u[0],endToken:x})),";"===e.peek().type&&e.next(),s(e),e.start=e.pos}else{if("}"===i.type)return e.next(),c(e),e.backUp(1),void 0;e.next()}}function p(t){var n=0;if(e.each(t,function(e){"{"===e.type?n++:"}"===e.type&&n--}),n)throw"Invalid CSS structure"}var h=/[ \t]+/g,d={white:!0,line:!0,comment:!0},g={white:!0,line:!0},v={";":!0,"{":!0},m={";":!0,"}":!0},b={start:0,end:0};return r.prototype={addChild:function(e){return e.parent=this,this.children.push(e),e},rawName:function(){return this.nameRange?this.nameRange.substring(this.source()):""},name:function(t){return null===this._name&&(this._name=u(this._nameTokens()||this.rawName()).join(", ").trim(),"property"===this.type&&(this._name=e.last(this._name.split(/\s+/)))),t?(null===this._nameLower&&(this._nameLower=this._name.toLowerCase()),this._nameLower):this._name
},rawValue:function(){return this.valueRange?this.valueRange.substring(this.source()):""},value:function(){return this._value||(this._value=this.rawValue().trim()),this._value},valueOf:function(e){e=e||"";var t="";return this.children.forEach(function(n){t+=e+"(n)"+n.name(),t+=n.children.length?"\n"+n.valueOf(e+"	"):": (v)"+n.value()+"\n"}),t},root:function(){if(!this.parent)return this;for(var e=this.parent;e.parent;)e=e.parent;return e},properties:function(){var t=[],n=-1;return e.each(this.children,function(e){"property"==e.type&&t.push({name:e.name().trim(),value:e.value().trim(),index:++n})}),t},_nameTokens:function(){var e=this._hints.name;return e?this.root().tokens.slice(e[0],e[1]):void 0},range:function(){if(!this.parent)return n.create2(0,this.source);var e=this.nameRange.start,t=this.valueRange?this.valueRange.end:this.nameRange.end;return n.create2(e,t)},fullRange:function(){var e=this._hints,t=this.root().tokens;if(t&&"startToken"in e&&"endToken"in e){var r=t[e.startToken],i=t[e.endToken];return n.create2(r.start,i.end)}},toSource:function(){return this.range().substring(this.source()).trim()},toFullSource:function(){return this.fullRange().substring(this.source())},source:function(){var e=this.root();return e._dirty&&(e._source=t.toSource(e.tokens),e._dirty=!1),e._source},toJSONCache:function(){if(!this.parent)return this.children.map(function(e){return e.toJSONCache()});var e={name:this.name(),value:this.value(),type:this.type};return"property"==this.type?e.value=this.value():e.children=this.children.map(function(e){return e.toJSONCache()}),e},all:function(){var e=[],t=function(n){for(var r=0,i=n.children.length;i>r;r++)e.push(n.children[r]),t(n.children[r])};return t(this),e},_allSiblings:function(){for(var t,n=[],r=this,i=function(e){n.push(e);for(var t=0,r=e.children.length;r>t;t++)i(e.children[t])};r.parent;){t=r.parent.children;for(var a=e.indexOf(t,r)+1,o=t.length;o>a;a++)i(t[a]);r=r.parent,r&&n.push(r)}return n},index:function(){return this.parent?this.parent.children.indexOf(this):0},remove:function(){if(this.parent){var e=this._hints.startToken,t=this._hints.endToken,n=t-e+1,r=this.root().tokens,i=r[e].start,o=r[t].end,u=o-i,s=this._allSiblings(),c=this.index();this.parent.children.splice(c,1),a(s,{tokenStart:e,tokenOffset:-n,charStart:i,charOffset:-u}),r.splice(e,n);for(var l,f=e,p=r.length;p>f;f++)l=r[f],l.start-=u,l.end-=u;this.root()._dirty=!0}},insert:function(t,n){e.isUndefined(n)&&(n=this.children.length);var r,i=this.root().tokens,o=null;if(this.parent||0!==n)if(this.children[n])r=this.children[n]._allSiblings(),r.unshift(this.children[n]),o=this.children[n]._hints.startToken;else{if(this.parent){for(o=this._hints.endToken;o>=0&&"}"!==i[o].type;)o--;if(o<=this._hints.startToken)throw"Invalid CSS section"}else o=this._hints.endToken+1;r=this._allSiblings()}else o=this.children.length?0:i.length;if(null===o||e.isUndefined(o))throw"Unable to insert subtree: target token is unavailable";var u,s=0;u=o>=i.length?(e.last(i)||b).end:i[o].start;for(var c=e.map(t.tokens,function(t){return t=e.clone(t),t.start+=u,t.end+=u,s+=t.value.length,t}),l=o,f=i.length;f>l;l++)i[l].start+=s,i[l].end+=s;a(t.all(),{tokenStart:0,tokenOffset:o,charStart:0,charOffset:o&&i[o-1]?i[o-1].end:0}),a(r,{tokenStart:o,tokenOffset:c.length,charStart:u,charOffset:s}),c.unshift(o,0),i.splice.apply(i,c),this.children.splice.apply(this.children,[n,0].concat(t.children));var p=this;t.children.forEach(function(e){e.parent=p});var h=this.root();h._hints.endToken=i.length-1,h._dirty=!0},replace:function(e){var t=this.index(),n=this.parent;return this.remove(),n.insert(e,t)}},i.prototype={hasNext:function(){return this.pos<this.len},next:function(){return this.tokens[this.pos++]},peek:function(){return this.tokens[this.pos]},curRange:function(e){var t=this.tokens[this.start];return n.create2(t.start,this.peek()[e?"start":"end"])},backUp:function(e){this.pos-=e},skipTo:function(e){for(;++this.pos<this.len&&!(this.tokens[this.pos].type in e););}},{build:function(n){var r;e.isString(n)?r=t.parse(n):(r=n,n=t.toSource(r)),p(r);for(var a=new i(r,n);a.hasNext();)f(a);return a.root},fromJSONCache:function(t,n){return e.isString(t)&&(t=JSON.parse(t)),n=n||new r(null,null,{type:"root"}),e.each(t,function(e){var t=new r;t._name=e.name,t._value=e.value,t.type=e.type,n.addChild(t),e.children&&this.fromJSONCache(e.children,t)},this),n},parseSelectors:u,CSSNode:r,TokenIterator:i}}),r("locator",["lodash","tree"],function(e,t){function r(e){if(!e.parent)return null;if(!e.__sectionPath){for(var t=e.name(),n=t.toLowerCase(),r=e.parent.children,i=1,a=0,o=r.length;r[a]!==e&&o>a;a++)r[a].name(!0)===n&&i++;e.__sectionPath=[t,i]}return e.__sectionPath}function i(t,n){if(n=e.extend({syntax:"css"},n||{}),"scss"==n.syntax){for(var r,i=[],a=t;a.parent;){if(r=t.name(),/^@media/i.test(r)){if(!i.length)return r;break}i.push(t.name()),a=a.parent}return i.join(" ")}return t.name()}function a(e){for(var t,n=[];t=e.pop();)"&"==t.charAt(0)?n.push(e.pop()+t.substr(1)):n.push(t);return n.reverse().join(" ")}if("undefined"==typeof emmet)try{emmet=n("vendor/emmet")}catch(o){}return{stringifyPath:function(t,n){return e.isString(t)?t:t.map(function(e){return e[0]+(!n&&e[1]>1?"|"+e[1]:"")}).join("/")},createPath:function(t,n){if(e.isObject(n)||(n={asString:!!n}),!t.__path){for(var i=[];t.parent;)i.push(r(t)),t=t.parent;if(i=i.reverse(),"scss"==n.syntax){for(var o,u=[],s=[],c=/^@media/i;o=i.shift();)c.test(o[0])?(s.length&&(u.push([a(s),1]),s=[]),u.push(o)):s.push(o[0]);s.length&&u.push([a(s),1]),i=u}t.__path=i}return n.asString?this.stringifyPath(t.__path):t.__path},parsePath:function(t){if(!e.isString(t))return t;if("["==t.charAt(0)||"{"==t.charAt(0))return JSON.parse(t);for(var n,r,i,a=[],o=/\|(\d+)$/,u=emmet.require("stringStream").create(t);r=u.next();)switch(r){case"/":n=u.current().trim(),a.push(n.substring(0,n.length-1).trim()),u.start=u.pos;break;case'"':case"'":for(;i=u.next();)if("\\"==i)u.next();else if(i==r)break}return a.push(u.current().trim()),e.compact(a).map(function(e){var t=1;return e=e.replace(o,function(e,n){return t=+n,""}),[e,t]})},normalizePath:function(e){return this.parsePath(e).map(function(e){return[t.parseSelectors(e[0]).join(", "),e[1]]})},locate:function(t,n,r){if(r=r||{},"scss"==r.syntax)return this.locateSCSS(t,n);n=this.normalizePath(n);for(var a,o,u,s=t;(o=n.shift())&&(u=o[0].toLowerCase(),a=e.filter(s.children,function(e){var t=i(e,r);return t==o[0]||t.toLowerCase()==u}),s=a[o[1]-1]););return s},locateSCSS:function(e,t){t=this.normalizePath(t);for(var n,r,i=this,a={syntax:"scss"},o=e.all().map(function(e){return{path:i.createPath(e,a),node:e}}),u=0;n=t.shift();){if(r=n[0].toLowerCase(),o=o.filter(function(e){return e.path[u]?e.path[u][0].toLowerCase()==r:void 0}),!o[n[1]-1]){o=null;break}o=[o[n[1]-1]],u++}return o&&o[0]?o[0].node:null},guessLocation:function(t,n){n=this.normalizePath(n);for(var r,i,a=function(t,n){return e.isArray(n)&&(n=n[0]),t.filter(function(e){return e.name()==n})},o=t;r=n.shift();){var u=this.locate(o,[r]);if(u||(i=a(o.children,r),i.length&&(n[0]&&(u=e.last(i.filter(function(e){return a(e.children,n[0]).length}))),u||(u=e.last(i)))),!u){n.unshift(r);break}o=u}return{found:o!==t,node:o,rest:n.length?n:null}},locateByPos:function(e,t){for(var n,r=0,i=e.children.length;i>r;r++)if(n=e.children[r],n.range().include(t))return this.locateByPos(n,t)||n}}}),r("diff",["lodash","tree","locator"],function(e,t,n){function r(e){return e instanceof t.CSSNode?e:t.build(e)}function i(e,t){if(t=t||[],e&&e.children)for(var n,r=0,a=e.children.length;a>r;r++)n=e.children[r],"property"!=n.type&&(t.push(n),i(n,t));return t}function a(t,r){return t instanceof Array||(t=i(t)),e.map(t,function(e){var t=n.createPath(e,r);return{path:t,pathString:n.stringifyPath(t,!0),section:e}})}function o(t){return t=e.isString(t)?t.toLowerCase():t.name().toLowerCase(),t in l}function u(t,n){var r=t.properties(),i=n.properties(),a=[],o=[],u=[],s=0;return e.each(i,function(e){var t=r[s];if(!t)return a.push(e);if(e.name===t.name)return++s,e.value!==t.value&&o.push(e),void 0;for(var n=s+1,i=r.length;i>n;n++)if(r[n].name===e.name&&r[n].value===e.value)return u=u.concat(r.slice(s,n)),s=n+1,void 0;a.push(e)}),u=u.concat(r.slice(s,r.length)),0===a.length+o.length+u.length?null:{added:a,updated:o,removed:u}}function s(e,t){if(o(e))return e.value()==t.value();var n=e.properties(),r=t.properties();if(n.length!==r.length)return!1;for(var i=0,a=n.length;a>i;i++)if(n[i].name!==r[i].name||n[i].value!==r[i].value)return!1;return!0}function c(e,t){for(var n,r,i=0,a=t.length;a>i;i++){r=t[i];for(var n,o=0,u=e.length;u>o;o++)if(n=e[o],n.pathString==r.pathString&&s(n.section,r.section)){e.splice(o,1),t.splice(i,1),a--,i--;break}}}var l={"@import":!0,"@charset":!0};return{diff:function(t,n,i){i=e.extend({syntax:"css"},i||{});var s=r(t,i),l=r(n,i),f=a(s,i),p=a(l,i),h=[];return c(f,p),e.each(p,function(t){var n=e.find(f,function(e){return e.pathString==t.pathString}),r={path:t.path,action:n?"update":"add"};if(o(t.section)&&(r.value=t.section.value()),"update"==r.action){if(!("value"in r)){var i=u(n.section,t.section);r.properties=i.added.concat(i.updated),r.removed=i.removed}f=e.without(f,n)}else"value"in r||(r.properties=t.section.properties());h.push(r)}),e.each(f,function(e){h.push({path:e.path,action:"remove"})}),h},diffSections:u,shouldCompareValues:o}}),r("patch",["lodash","tree","locator","diff","cssParser"],function(e,t,r,i){function a(e,t,n){return e+n.selSep+"{"+n.indent+t+n.end+"}"}function o(t){var n,r=e.clone(p);"property"==t.type&&(t=t.parent);for(var i,a=function(e){for(var t=0,n=e.children.length;n>t;t++)if("property"==e.children[t].type)return!0;return!1},o=t;o=o.parent;)if(i=e.find(o.children,a)){o=i;break}if(o||(o=e.find(t.all(),a)),o&&o.parent){r.selSep=o.rawName().match(/([\s\n\r]+)$/)?RegExp.$1:"";try{n=emmet.require("cssEditTree").parse(o.toSource())}catch(u){}}if(n){var s=e.last(n.list());s&&(r.indent=s.styleBefore,r.sep=s.styleSeparator,r.end=n.source.substring(s.fullRange().end,n.source.length-1))}return r}function u(e,t){if(t=t.toLowerCase(),"@charset"==t)return 0;if("@import"==t){for(var n,r=0,i=e.children.length;i>r;r++)if(n=e.children[r].name().toLowerCase(),"@charset"!=n&&"@import"!=n)return r;return 0}return e.children.length}function s(n,s,c){var f=r.guessLocation(n,s);if(f.node.parent){var p=f.node.name().toLowerCase();"@import"==p&&"add"==c.action&&(f.rest||(f.rest=[]),f.rest.unshift([p]),f.node=f.node.parent)}if(f.rest){var h="",d=o(f.node),g=emmet.require("utils"),v=f.rest[0][0],m=f.rest.pop();i.shouldCompareValues(m[0])&&"value"in c?h=m[0]+" "+c.value+";":(h=a(m[0],"",e.defaults({indent:""},d)),h=l(t.build(h).children[0],c,d));for(var b=d.indent.match(/([ \t]+)$/)?RegExp.$1:"",y=f.rest.length-1;y>=0;y--)h=a(f.rest[y][0],g.padString(h,b),d);var x=u(f.node,v),_=f.node.children.length;_&&x!==_?h+=d.sectionSep:_&&(h=d.sectionSep+h),f.node.insert(t.build(h),x)}else{var k=l(f.node,c);f.node.replace(t.build(k))}}function c(e,t){var n,r=e.toFullSource(),i=e.rawValue(),a=e.fullRange().start,o=e.valueRange.start-a,u=e.valueRange.end-a;(n=i.match(h))&&(o+=n[0].length),(n=i.match(d))&&(u-=n[0].length);var s=i?"":" ",c=r.substring(0,o)+s+t.value+r.substring(u);return c}function l(t,n,r){if("value"in n)return c(t,n);r=r||o(t);var i=emmet.require("cssEditTree").parse(t.toFullSource(),{styleBefore:r.indent,styleSeparator:r.sep});return e.each(n.properties,function(t){var n;"index"in t&&(n=i.get(t.index),n&&n.name()==t.name||(n=e.last(i.getAll(t.name)))),n?n.value(t.value):i.value(t.name,t.value)}),e.each(n.removed,function(e){i.remove(e.name)}),i.source}if("undefined"==typeof emmet)try{emmet=n("vendor/emmet")}catch(f){}var p={selSep:" ",sectionSep:"\n",indent:"\n	",sep:": ",end:"\n"},h=/^\s+/,d=/\s+$/;return{condense:function(t){var n={},i=function(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n].name===t)return e[n]};return e.each(t,function(e){var t=r.stringifyPath(e.path);t in n||(n[t]=[]),n[t].push(e)}),e.map(n,function(t){var n=e.cloneDeep(t[0]);return e.each(e.rest(t),function(t){return"remove"==t.action||"remove"==n.action?n=t:(n.action="update",n.removed=e.filter(n.removed,function(e){return!i(t.properties,e.name)}),n.properties=n.properties.concat(e.filter(t.properties,function(e){var t=i(n.properties,e.name);return t?(t.value=e.value,!1):!0})),n.removed=n.removed.concat(e.filter(t.removed,function(e){return!i(n.removed,e.name)})),void 0)}),n})},patch:function(n,i,a){i=this.condense(e.isArray(i)?i:[i]);var o=e.isString(n)?t.build(n):n;return e.each(i,function(e){var n=r.parsePath(e.path),i=r.locate(o,n,a);if("remove"===e.action)return i&&i.remove(),void 0;if(i){var u=l(i,e);i.replace(t.build(u))}else s(o,n,e)}),o.source()},learnStyle:o}}),r("eventMixin",[],function(){var e=/\s+/,t=Array.prototype.slice;return{on:function(t,n,r){var i,a,o,u,s;if(!n)return this;for(t=t.split(e),i=this._callbacks||(this._callbacks={});a=t.shift();)s=i[a],o=s?s.tail:{},o.next=u={},o.context=r,o.callback=n,i[a]={tail:u,next:s?s.next:o};return this},off:function(t,n,r){var i,a,o,u,s,c;if(a=this._callbacks){if(!(t||n||r))return delete this._callbacks,this;for(t=t?t.split(e):_.keys(a);i=t.shift();)if(o=a[i],delete a[i],o&&(n||r))for(u=o.tail;(o=o.next)!==u;)s=o.callback,c=o.context,(n&&s!==n||r&&c!==r)&&this.on(i,s,c);return this}},trigger:function(n){var r,i,a,o,u,s,c;if(!(a=this._callbacks))return this;for(s=a.all,n=n.split(e),c=t.call(arguments,1);r=n.shift();){if(i=a[r])for(o=i.tail;(i=i.next)!==o;)i.callback.apply(i.context||this,c);if(i=s)for(o=i.tail,u=[r].concat(c);(i=i.next)!==o;)i.callback.apply(i.context||this,u)}return this}}}),r("socket",["lodash","eventMixin"],function(e,t){function n(e){var t=!1,c=new WebSocket(i);r&&(clearTimeout(r),r=null),c.onclose=function(){a=null,s.trigger("close"),!t&&e&&e(!1),u&&(r=setTimeout(n,o,e))},c.onopen=function(){a=c,t=!0,e&&e(!0,a),s.trigger("open")},c.onmessage=function(e){s.trigger("message",JSON.parse(e.data))},c.onerror=function(e){s.trigger("error",e)}}var r,i="ws://localhost:54000/browser",a=null,o=1e3,u=!0,s={connect:function(e){this.active()?e&&e(!0,a):(u=!0,n(e))},disconnect:function(){this.active()&&(u=!1,a.close())},active:function(){return!!a},check:function(){this.active()||n()},send:function(t){e.isString(t)||(t=JSON.stringify(t)),this.active()&&a.send(t)}};return e.extend(s,t)}),r("dispatcher",["lodash","eventMixin"],function(e,t){return e.extend({},t)}),r("path",[],function(){function e(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,n=function(e){return t.exec(e).slice(1)};return{sep:"/",delimiter:":",resolve:function(){for(var t="",n=!1,r=arguments.length-1;r>=-1&&!n;r--){var i=r>=0?arguments[r]:"";if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(t=i+"/"+t,n="/"===i.charAt(0))}return t=e(t.split("/").filter(function(e){return!!e}),!n).join("/"),(n?"/":"")+t||"."},normalize:function(t){var n=this.isAbsolute(t),r="/"===t.substr(-1);return t=e(t.split("/").filter(function(e){return!!e}),!n).join("/"),t||n||(t="."),t&&r&&(t+="/"),(n?"/":"")+t},isAbsolute:function(e){return"/"===e.charAt(0)},join:function(){var e=Array.prototype.slice.call(arguments,0);return this.normalize(e.filter(function(e){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},relative:function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=this.resolve(e).substr(1),t=this.resolve(t).substr(1);for(var r=n(e.split("/")),i=n(t.split("/")),a=Math.min(r.length,i.length),o=a,u=0;a>u;u++)if(r[u]!==i[u]){o=u;break}for(var s=[],u=o;u<r.length;u++)s.push("..");return s=s.concat(i.slice(o)),s.join("/")},dirname:function(e){var t=n(e),r=t[0],i=t[1];return r||i?(i&&(i=i.substr(0,i.length-1)),r+i):"."},basename:function(e,t){var r=n(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},extname:function(e){return n(e)[3]},prettifyPaths:function(e){for(var t={},n=(function(e){return e in t||(t[e]=0),t[e]++,e}),r=function(){return!Object.keys(t).some(function(e){return t[e]>1})},i=this,a=e.map(function(e){return{name:n(i.basename(e)),dir:i.dirname(e),path:e}}),o=!1;!r()&&!o;)t={},a=a.map(function(e){var t=i.join(i.basename(e.dir),e.name);return t===e.name&&(o=!0),{name:n(t),dir:i.dirname(e.dir),path:e.path}});return a}}}),r("extension/panelView",["lodash","path","eventMixin"],function(e,t,n){function r(e,t){return(t||h).getElementsByClassName(e)[0]}function i(){var t=JSON.stringify(b);return b={},e.each(h.querySelectorAll(".mappings .sources__item"),function(e){var t=r("sources__browser",e).getAttribute("title"),n=r("sources__editor",e).value;b[t]=n||null}),t!==JSON.stringify(b)&&x.trigger("saveAssociations",b),b}function a(n){return n=t.prettifyPaths(n),'<select name="editor-file" class="sources__editor"><option value="">...</option>'+n.map(function(t){return'<option value="'+t.path+'">'+e.escape(t.name||t.path)+"</option>"})+"</select>"}function o(e,n){if(e&&n){var i=a(n),o=r("sources"),u=/^livestyle:/i,s=0;o.innerHTML=t.prettifyPaths(e).map(function(e){var t=u.test(e.path),n=t?"user CSS "+ ++s:e.name,r=n.split("?");return'<li class="sources__item'+(t?" sources__item_user":"")+'">'+'<i class="remove"></i>'+'<span class="sources__browser" title="'+e.path+'">'+(r.shift()||e.path)+(r.length?'<span class="sources__qs">?'+r.join("?")+"</span>":"")+"</span> "+'<i class="dirs"></i> '+i+"</li>"}).join(""),f(b)}}function u(t,n){var r=t.split(_).reverse(),i=n.split(_).reverse(),a=r.length>i.length?i:r,o=r.length>i.length?r:i,u=0;return e.find(a,function(e,t){return e===o[t]?(u+=1,!1):e.toLowerCase()==o[t].toLowerCase()?(u+=.2,!1):!0}),u}function s(e,t){var n=-1,r=0;return t.forEach(function(t,i){var a=u(e,t);a>r&&(r=a,n=i)}),-1==n?null:t[n]}function c(t,n){e.find(t,function(e){return e.value==n?e.selected=!0:void 0})}function l(t){t=t||{};var n={};return e.each(h.getElementsByClassName("sources__item"),function(i){var a=r("sources__browser",i),o=a.getAttribute("title");a.textContent.trim().split("?")[0];var u=i.querySelectorAll(".sources__editor option"),l=e.pluck(u,"value");if(o in t)c(u,t[o]);else{var f=s(o,l);null!==f?(c(u,f),n[o]=f):c(u,"")}}),Object.keys(n).length?n:null}function f(t){y=!0;var n=l(t);n&&(b=e.extend(b||{},n),i()),y=!1}function p(e,t){for(;e;){if(e.classList.contains(t))return e;e=e.parentNode}}var h=document.createElement("div");h.innerHTML='<div class="socket"><span class="socket__status active">Editor name</span><span class="socket__status inactive">No active editor <i class="reload"></i></span></div><div class="livestyle-toggler"><input type="checkbox" name="enabled" class="livestyle-enabled" id="livestyle-enabled" /> <label for="livestyle-enabled">Enable LiveStyle for current page</label></div><div class="mappings"><h2>File mapping</h2><p>Associate web page files (on the left) with editor files (on the right). Open more CSS files in editor to make them appear in drop-down menus.</p><ul class="sources"></ul></div>',h.className="livestyle livestyle_disabled";var d=!1,g=null,v=null,m=null,b=null,y=!1,x=null,_=/[\/\\]/g;x=e.extend({identifyEditor:function(e){if(e){var t=e.title;e.icon&&(t='<img src="'+e.icon+'" alt="'+e.title+'" class="socket__editor-icon" /> '+t),g=e.id,h.querySelector(".socket__status.active").innerHTML=t,this.editorFiles=e.files,this.socketActive=!0}},renameEditorFile:function(t,n){b&&(e.each(b,function(e,r){e===t&&(b[r]=n)}),v&&(this.editorFiles=v.map(function(e){return e===t?n:e})),x.trigger("saveAssociations",b))},get view(){return h},get pluginActive(){return d},set pluginActive(e){d!==e&&(d=e,this.trigger(e?"enable":"disable"))},get socketActive(){return r("socket").classList.contains("active")},set socketActive(e){r("socket").classList[e?"add":"remove"]("active"),this.trigger("socket:active",e)},get editorFiles(){return v},set editorFiles(e){v=e,o(m,v)},get browserFiles(){return m},set browserFiles(e){m=e,o(m,v)},get assocs(){return e.clone(b)},set assocs(t){b=e.clone(t),m&&f(b)},associatedFile:function(t){var n=null;return e.each(b,function(e,r){e==t&&(n=r)}),n}},n),x.on("enable",function(){h.classList.remove("livestyle_disabled"),r("livestyle-enabled").checked=!0}),x.on("disable",function(){h.classList.add("livestyle_disabled"),r("livestyle-enabled").checked=!1}),r("livestyle-enabled").addEventListener("click",function(){x.pluginActive=this.checked},!1);var k=r("mappings");return k.addEventListener("change",function(){y||i()},!1),k.addEventListener("click",function(e){if(e.target.classList.contains("remove")){var t=p(e.target,"sources__item");if(t){var n=r("sources__browser",t);x.trigger("removeFile",n.title)}}y||i()},!1),h.querySelector(".socket__status .reload").addEventListener("click",function(){x.trigger("socket:reload")},!1),x}),function(e,t){"function"==typeof r&&r.amd?r("emSelect",t):e.emSelect=t()}(this,function(){function e(e){this.data=e||{}}function t(e,t){var n=document.createElement(e);return t&&(n.className=t),n}function n(e,t){for(;e.parentNode;){if(e.classList.contains(t))return e;e=e.parentNode}}function r(e,t){return"string"==typeof t&&arguments.length>2?e.setAttribute(t,arguments[2]):"object"==typeof t&&Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])}),e}function i(e){return"string"==typeof e?e:e.getAttribute("data-widget-id")}function a(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function o(e){var n=i(e),a=f[n].select,o=f[n].options,u=t("ul","em-select__opt");f[n].popup=u;for(var s,c,l,p=0,h=a.options.length;h>p;p++)l=a.options[p],s=t("li","em-select__opt-item"),r(s,{"data-ix":p,"data-value":l.value,"data-label":l.label}),a.selectedIndex==p&&(s.className+=" em-select__opt-item_selected"),c=t("span","em-select__opt-item-label"),c.innerHTML=l.label,s.appendChild(c),o.invoke("onItemCreate",s),u.appendChild(s);return o.invoke("onItemListPopulate",u),u}function u(e){var t=i(e),n=f[t];n.widget.classList.contains("em-select_active")||(n.widget.classList.add("em-select_active"),n.widget.appendChild(o(t)),n.options.invoke("onPopupShow",t))}function s(e){var t=i(e),n=f[t];n&&n.widget.classList.contains("em-select_active")&&(n.widget.classList.remove("em-select_active"),n.popup&&(n.options.invoke("onPopupHide",t),a(n.popup),n.popup=null))}function c(){Object.keys(f).forEach(s)}var l=Array.prototype.slice,f={},p=0;e.prototype.get=function(e,t){return e in this.data?this.data[e]:t},e.prototype.invoke=function(e){return"function"==typeof this.data[e]?this.data[e].apply(this.data,l.call(arguments,1)):void 0},document.addEventListener("click",function(e){var t=n(e.target,"em-select__opt-item");if(t){var r=n(t,"em-select"),a=i(r),o=f[a].options.invoke("onItemClick",t,a,e);if(o!==!1){f[a].select.value=t.getAttribute("data-value");var l=document.createEvent("HTMLEvents");l.initEvent("change",!1,!0),f[a].select.dispatchEvent(l),s(a)}}else{var p=n(e.target,"em-select");if(p){var a=i(p);return f[a].widget.classList.contains("em-select_active")?s(a):u(a),void 0}c()}},!1);var h=function(n,i){var a="em"+ ++p;i=new e(i);var o=t("span","em-select"),u=t("span","em-select__label"),s=i.get("label","...");"undefined"!=typeof n.selectedIndex&&(s=n.options[n.selectedIndex].label),u.innerHTML=s,o.appendChild(u),r(n,"data-widget-id",a),r(o,"data-widget-id",a),n.style.cssText+=";visibility:hidden;position:absolute;left:-2000px;",n.addEventListener("change",function(){u.innerHTML=n.options[n.selectedIndex].label},!1),n.parentNode.insertBefore(o,n),f[a]={select:n,widget:o,options:i,popup:null}};return h.hide=s,h.hideAll=c,h.destory=function(e){var t=i(e);t&&t in f&&(a(f[t].widget),a(f[t].popup),delete f[t]),e.nodeType&&e.removeAttribute("data-widget-id")},h.widgetData=function(e){var t=i(e);return f[t]},h}),r("extension/patchHistory",["lodash","eventMixin","emSelect"],function(e,t,n){function r(e,t){var n=document.createElement(e);return"string"==typeof t?n.className=t:"object"==typeof t&&Object.keys(t).forEach(function(e){n.setAttribute(e,t[e])}),n}function i(e,t){return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()}function a(e){return(10>e?"0":"")+e}function o(e){e=new Date(e);var t=new Date,n=new Date,r="";return i(e,t)?r=g.today:i(e,n)?r=g.yesterday:(r=d[e.getMonth()]+" "+e.getDate(),e.getFullYear()!=t.getFullYear()&&(r+=", "+e.getFullYear())),r+", "+a(e.getHours())+":"+a(e.getMinutes())}function u(e){return e=new Date(e),[e.getFullYear(),a(e.getMonth()+1),a(e.getDate()),a(e.getHours()),a(e.getMinutes())].join("-")}function s(e){return e.meta.patchHistory?e.meta.patchHistory.filter(function(e){return!!Object.keys(e.styles).length}).sort(function(e,t){return t.date-e.date}).map(function(e,t){return{label:o(e.date),value:t}}):[]}function c(){Object.keys(v).forEach(function(e){window.URL.revokeObjectURL(e.url)}),v={}}function l(e){c(),e.meta.patchHistory&&e.meta.patchHistory.filter(function(e){return!!Object.keys(e.styles).length}).forEach(function(e,t){var n={id:"livestyle",files:e.styles},r=JSON.stringify(n,null,"	"),i=new Blob([r],{type:"application/octet-stream"});v[t+""]={styles:e.styles,url:window.URL.createObjectURL(i),filename:"lspatch-"+u(e.date)+".json"}})}function f(e){return Object.keys(e.styles).map(function(t){return{browserFile:t,patch:e.styles[t]}})}function p(e,t){e&&(e.options.length=0,e.appendChild(r("option",{label:"Patch history",value:""})),t.forEach(function(t){e.appendChild(r("option",t))}))}var h=null,d=["January","February","March","April","May","June","July","August","September","October","November","December"],g={today:"Today",yesterday:"Yesterday"},v={},m={onItemListPopulate:function(e){var t=e.getElementsByClassName("em-select__opt-item")[0];t.parentNode.removeChild(t)},onItemCreate:function(e){var t=e.getAttribute("data-value");if(t){var n=r("a",{"class":"patch-download",href:v[t].url,download:v[t].filename,title:"Download patch"});n.innerHTML="&#11015;",e.appendChild(n)}},onItemClick:function(e,t,r){if(!r.target.classList.contains("patch-download")){var i=e.getAttribute("data-value");h.trigger("patchSelected",f(v[i]))}return n.hide(t),!1}};return h=e.extend({init:function(e,t){t=t||document;var i=t.querySelector('select[name="patch-history"]');i&&(i.parentNode.removeChild(i),n.destory(i));var a=r("select",{name:"patch-history"}),o=r("span","patch-history__wrap");o.appendChild(a),l(e),p(a,s(e)),t.querySelector(".mappings h2").appendChild(o),n(a,m)},update:function(e,t){t=t||document,l(e),p(t.querySelector('select[name="patch-history"]'),s(e))}},t)}),r("webkit/utils",[],function(){return{mainFrame:function(){return WebInspector.frameResourceManager.mainFrame},inspectedPageUrl:function(){return this.mainFrame().url}}}),r("webkit/pageSettings",["lodash","patch","dispatcher","webkit/utils"],function(e,t,n,r){function i(t,n){var r=p.value||[],i=a(r,t);return-1===i&&(r.push([t,e.cloneDeep(h)]),i=r.length-1),n(r[i][1],t,{index:i,full:r})}function a(e,t){for(var n=0;n<e.length;n++)if(e[n][0]===t)return n;return-1}function o(n,r,a){i(n,function(i){if(i.meta.patchHistory){var o=e.last(i.meta.patchHistory);o&&o.styles&&(o.styles[r]||(o.styles[r]=[]),o.styles[r]=t.condense(o.styles[r].concat(a)),c.save({url:n,value:i}))}})}function u(e){i(e,function(t){t.meta.patchHistory||(t.meta.patchHistory=[]);var n=t.meta.patchHistory.filter(function(e){return!!Object.keys(e.styles).length});for(n.push({date:Date.now(),styles:{}});n.length>=f;)n.shift();t.meta.patchHistory=n,c.save({url:e,value:t})})}function s(e){if(/^blob:/i.test(e.url)){var t=e.source.match(/\/\*\s+(livestyle:[\w\-]+)/);return t?t[1]:null}return e.url}var c,l=30,f=10,p=new WebInspector.Setting("livestyle.pageSettings",[]),h={enabled:!1,assocs:null,meta:{},userfiles:[]};return n.on("start",function(){WebInspector.Frame.addEventListener(WebInspector.Frame.Event.MainResourceDidChange,function(e){e.target.isMainFrame()&&u(r.inspectedPageUrl())}),u(r.inspectedPageUrl())}),n.on("sourcePatched",function(e){o(r.inspectedPageUrl(),s(e),e.patches)}),c={get:function(e,t){return e&&e.url?(i(e.url,t),void 0):(console.error("No data for page settings"),t(null))},save:function(t){this.get(t,function(r,i,a){var o=a?a.full:[];if(r=e.extend(r,t.value),a)o[a.index][1]=r;else{for(;o.length>=l;)o.shift();o.push([i,r])}p.value=o,n.trigger("pageSettingsChanged",r)})}}}),r("webkit/styles",["lodash","webkit/utils"],function(e,t){function n(){o=null}function r(e,t){var n=WebInspector.cssStyleManager.styleSheetForIdentifier(e);n.requestContent(function(e){t(e.content)})}function i(n){if(o)return n(o);var i=t.mainFrame().resourcesWithType(WebInspector.Resource.Type.Stylesheet).map(function(e){return e.url});CSSAgent.getAllStyleSheets(function(t,a){if(t)return n(null);var u=[],s=function(){if(a.length){var t=a.shift();e.include(i,t.sourceURL)?r(t.styleSheetId,function(e){u.push({id:t.styleSheetId,url:t.sourceURL,realUrl:t.sourceURL,content:e}),s()}):s()}else n(o=u)};s()})}var a={},o=null;return WebInspector.Resource.addEventListener(WebInspector.SourceCode.Event.ContentDidChange,n),WebInspector.Resource.addEventListener(WebInspector.Resource.Event.URLDidChange,n),{all:i,add:function(e,t){console.error("Not implemented yet"),t(null)},remove:function(e,t){console.error("Not implemented yet"),t(null)},isUserFile:function(){return!1},isBlobFile:function(){return!1},generateUserFileName:function(){return"livestyle:user"},lookupInternalUrl:function(e){return a[e]},lookupBlobUrl:function(e){for(var t=Object.keys(a),n=t.length-1;n>=0;n--)if(a[t[n]]===e)return t[n]},replaceContent:function(t,n){i(function(r){if(r&&r.length){var i=e.find(r,function(e){return e.realUrl==t});if(i){var a=WebInspector.cssStyleManager.styleSheetForIdentifier(i.id);WebInspector.branchManager.currentBranch.revisionForRepresentedObject(a).content=n}}})},requestResourceContent:function(t,n){CSSAgent.getAllStyleSheets(function(i,a){if(i)return n(null);var o=e.find(a,function(e){return e.sourceURL==t||e.styleSheetId==t});o?r(o.styleSheetId,n):n(null)})}}}),r("webkit/panel",["lodash","dispatcher","socket","extension/panelView","extension/patchHistory","webkit/pageSettings","webkit/styles","webkit/utils"],function(t,n,r,i,a,o,u,s){function c(){if(m.activated)b.parentNode&&b.parentNode.removeChild(b),m.activated=!1;else{var e=m._element.getBoundingClientRect();b.style.left=e.left-15+"px",b.style.top=e.bottom+15+"px",document.body.appendChild(b),m.activated=!0}}function l(){u.all(function(e){i.browserFiles=t.pluck(e,"url")})}function f(e){e&&(i.pluginActive=e.enabled,i.assocs=e.assocs)}function p(){d||(WebInspector.toolbar.addToolbarItem(m,WebInspector.Toolbar.Section.Left),d=!0),o.get({url:s.inspectedPageUrl()},function(e){f(e),l()})}function h(e){o.save({url:s.inspectedPageUrl(),value:e||{}})}var d=!1,g="undefined"!=typeof e?e:"",v=g+"NavigationItemEmmet.pdf",m=new WebInspector.ActivateButtonToolbarItem("livestyle","Show Emmet LiveStyle","Emmet LiveStyle","Emmet LiveStyle",v);m.addEventListener(WebInspector.ButtonNavigationItem.Event.Clicked,c),m.enabled=!0;var b=document.createElement("div");b.className="livestyle-webkit-view",b.appendChild(i.view),WebInspector.Resource.addEventListener(WebInspector.Resource.Event.URLDidChange,l),r.on("open",function(){i.socketActive=!0}).on("close",function(){i.socketActive=!1}).on("message",function(e){switch(e.action){case"id":i.identifyEditor(e.data);break;case"updateFiles":i.editorFiles=e.data;break;case"renameFile":i.renameEditorFile(e.data.oldname,e.data.newname)}}),n.on("pageSettingsChanged",function(e){f(e)}).on("start",p),i.on("saveAssociations",function(e){h({assocs:e})}).on("removeFile",function(){}).on("socket:reload",function(){r.check()}).on("enable",function(){h({enabled:!0})}).on("disable",function(){h({enabled:!1})}),a.on("patchSelected",function(e){n.trigger("applyPatch",e)})}),r("extension/webkit/livestyle",["lodash","patch","diff","socket","dispatcher","webkit/panel","extension/panelView","webkit/styles","webkit/pageSettings","webkit/utils"],function(t,n,r,i,a,o,u,s,c,l){function f(e){a.trigger("sourcePatched",{url:e.file,patches:e.result.patches,source:e.result.source})
}function p(e){w[e]=!0}function h(e){c.get({url:l.inspectedPageUrl()},function(t){var n={action:"update",data:{browserFile:e.url,editorFile:t?t.assocs[e.url]:null,patch:e.patches}};i.send(n)})}function d(e,r){var i=t.find(C,function(t){return t.url===e});i||(i={url:e,patches:[]},C.push(i)),t.isArray(r)||(r=[r]),i.patches=n.condense(i.patches.concat(r)),g()}function g(){if(!C.running&&C.length){C.running=!0;var e=C.shift();P.postMessage({action:"patch",file:e.url,source:k[e.url],patches:e.patches})}}function v(e){t.include(A,e)||A.push(e),m()}function m(){if(!A.running&&A.length){A.running=!0;var e=A.shift();s.requestResourceContent(e,function(t){null!==t?(s.isBlobFile(e)&&(e=s.lookupInternalUrl(e)),P.postMessage({action:"diff",file:e,source1:k[e],source2:t})):(A.running=!1,m())})}}function b(){k={},s.all(function(e){e.forEach(function(e){k[e.url]=e.content})})}function y(e,n){var r=e.browserFile;return r&&r in k||t.each(n.assocs,function(t,n){t==e.editorFile&&(r=n)}),r&&r in k?(d(r,e.patch),void 0):console.error("No associated file found")}function x(e){c.get({url:l.inspectedPageUrl()},function(n){if(n.enabled){var r=t.isArray(e)?e:[e];r.forEach(function(e){y(e,n)})}})}function _(){b(),i.connect()}var k={},w={},S="undefined"!=typeof e?e:"",C=[];C.running=!1;var A=[];A.running=!1;var P=new Worker(S+"worker.js");P.onmessage=function(e){var t=e.data;switch(t.action){case"patch":if(C.running=!1,t.success){var n=s.isUserFile(t.file)?s.lookupBlobUrl(t.file):t.file;k[t.file]=t.result.source,p(n),f(t),s.replaceContent(n,t.result.source)}else console.error(t.result);g();break;case"diff":if(A.running=!1,t.success){var r=t.result;k[t.file]=r.source,r.patches&&r.patches.length&&(h({url:t.file,patches:r.patches}),f(t))}else console.error(t.result);m()}},WebInspector.Resource.addEventListener(WebInspector.SourceCode.Event.ContentDidChange,function(e){var t=e.target;return t.url in w?(delete w[t.url],void 0):t.url in k&&t.content?(c.get({url:l.inspectedPageUrl()},function(e){e.enabled?v(t.url):k[t.url]=content}),void 0):(console.log('No "%s" resource in styles cache',t.url),void 0)}),a.on("saveAssociations",function(e){assocs=e}).on("applyPatch",x).on("start",function(){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.href=S+"panel.css",document.head.appendChild(e)}),i.on("message",function(e){switch(e.action){case"update":x(e.data)}});var O=!1;WebInspector.Frame.addEventListener(WebInspector.Frame.Event.MainResourceDidChange,function(e){O?e.target.isMainFrame()&&_():(O=!0,setTimeout(function(){_(),a.trigger("start")},1))})}),n("extension/webkit/livestyle")});